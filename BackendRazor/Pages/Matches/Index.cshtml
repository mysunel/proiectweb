@page "/Matches"
@model MyApp.Pages.Matches.IndexModel
@using System.Linq 
@{
    ViewData["Title"] = "Match Schedule";
}

<h1 class="text-4xl font-extrabold mb-12 tracking-wide text-gray-900">Match Schedule</h1>

<h2 class="text-3xl font-bold mb-4 mt-8 text-blue-700">Upcoming Matches (@Model.UpcomingMatches.Count)</h2>

@if (Model.UpcomingMatches.Any())
{
    <div class="space-y-6"> 
        @foreach (var match in Model.UpcomingMatches)
        {
            <a href="/matches/@(match.Idmatch)" class="block group no-underline! text-inherit!">
                <div class="w-full p-4 rounded-xl shadow-lg bg-linear-to-r from-teal-700 to-teal-900
                             transition transform duration-300 hover:scale-[1.01] hover:shadow-xl 
                             flex items-center justify-between relative "> 
                      
                    <div class="w-16 h-16 flex items-center justify-center relative z-10 shrink-0">
                        <img src="~/images/@(match.IdhomeNavigation?.Idteam + ".svg")"
                             alt="logo" class="max-w-full max-h-full object-contain drop-shadow-md" />
                    </div>

                    <div class="grow text-center mx-4">
                        <span class="text-xl font-bold text-white">
                            @match.IdhomeNavigation?.Name vs @match.IdguestNavigation?.Name 
                        </span>
                        <br />
                        <span class="text-sm text-gray-200 block mt-1 font-semibold">
                            @match.Date.ToString("dd MMM yyyy")
                        </span>
                    </div>
                    
                    <div class="w-16 h-16 flex items-center justify-center relative z-10 shrink-0">
                        <img src="~/images/@(match.IdguestNavigation?.Idteam + ".svg")"
                             alt="logo" class="max-w-full max-h-full object-contain drop-shadow-md" />
                    </div>
                </div>
           </a>
        }
    </div>
}
else
{
    <p class="text-gray-500 italic mt-4">No upcoming matches scheduled.</p>
}

<hr class="my-12 border-gray-300" />

<div class="bg-gray-100 p-6 rounded-xl mb-8 shadow-inner">
    <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
        <h2 class="text-3xl font-bold text-green-700">Completed Matches</h2>
        
        <form method="get" class="flex flex-wrap items-center gap-3">
            <div class="relative">
                <input type="text" name="searchString" value="@Model.CurrentFilter" 
                       placeholder="Search team name..." 
                       class="pl-4 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 outline-none shadow-sm text-sm" />
            </div>

            <select name="sortOrder" onchange="this.form.submit()" 
                    class="border border-gray-300 rounded-lg py-2 px-3 shadow-sm text-sm focus:ring-2 focus:ring-green-500 outline-none">
                <option value="date_desc" selected="@(Model.CurrentSort == "date_desc" ? "selected" : null)">Newest First</option>
                <option value="date_asc" selected="@(Model.CurrentSort == "date_asc" ? "selected" : null)">Oldest First</option>
            </select>

            <button type="submit" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition font-medium text-sm shadow-md">
                Apply Filters
            </button>
            
            @if (!string.IsNullOrEmpty(Model.CurrentFilter))
            {
                <a asp-page="./Index" class="text-sm text-red-600 hover:underline ml-2">Clear Search</a>
            }
            
            <input type="hidden" name="p" value="1" />
        </form>
    </div>
</div>

@if (Model.CompletedMatches.Any())
{
    <div class="space-y-6"> 
        @foreach (var match in Model.CompletedMatches)
        {
            string gradientClass = "from-blue-200 to-white";
            if (match.Scorehome > match.Scoreguest) gradientClass = "from-green-400 to-red-200";
            else if (match.Scorehome < match.Scoreguest) gradientClass = "from-red-400 to-green-200";

            <a href="/matches/@(match.Idmatch)" class="block group no-underline! text-inherit!">
                <div class="w-full p-4 rounded-xl shadow-lg bg-linear-to-r @gradientClass
                             transition transform duration-300 hover:scale-[1.01] hover:shadow-xl 
                             flex items-center justify-between relative overflow-hidden"> 
                      
                    <div class="w-16 h-16 flex items-center justify-center relative z-10 shrink-0">
                        <img src="~/images/@(match.IdhomeNavigation?.Idteam + ".svg")"
                             alt="logo" class="max-w-full max-h-full object-contain" />
                    </div>

                    <div class="grow text-center mx-4">
                        <span class="text-xl font-bold text-gray-900">
                            @match.IdhomeNavigation?.Name vs @match.IdguestNavigation?.Name 
                        </span>
                        <br />
                        <span class="text-2xl font-extrabold text-blue-700 mt-1 block">
                            @match.Scorehome : @match.Scoreguest
                        </span>
                        <span class="text-sm text-gray-600 block mt-1">
                            @match.Date.ToString("dd MMM yyyy") 
                        </span>
                    </div>
                    
                    <div class="w-16 h-16 flex items-center justify-center relative z-10 shrink-0">
                        <img src="~/images/@(match.IdguestNavigation?.Idteam + ".svg")"
                             alt="logo" class="max-w-full max-h-full object-contain" />
                    </div>
                </div>
           </a>
        }
    </div>

    <div class="flex justify-center items-center space-x-4 mt-10 pb-10">
        @if (Model.CurrentPage > 1)
        {
            <a asp-page="./Index" 
               asp-route-p="@(Model.CurrentPage - 1)" 
               asp-route-sortOrder="@Model.CurrentSort" 
               asp-route-searchString="@Model.CurrentFilter"
               class="px-5 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-700 transition shadow-md">
                &larr; Previous
            </a>
        }

        <span class="font-semibold text-gray-700 px-4 py-2 bg-white border rounded-lg shadow-sm">
            Page @Model.CurrentPage of @Model.TotalPages
        </span>

        @if (Model.CurrentPage < Model.TotalPages)
        {
            <a asp-page="./Index" 
               asp-route-p="@(Model.CurrentPage + 1)" 
               asp-route-sortOrder="@Model.CurrentSort" 
               asp-route-searchString="@Model.CurrentFilter"
               class="px-5 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-700 transition shadow-md">
                Next &rarr;
            </a>
        }
    </div>
}
else
{
    <p class="text-gray-500 italic mt-4 p-10 text-center bg-gray-50 rounded-lg">No completed matches found for this search.</p>
}